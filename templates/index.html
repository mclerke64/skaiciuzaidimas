<!DOCTYPE html>
<html>
<head>
    <title>Numbers Game</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: black; color: white; }
        .timer { font-size: 1.5em; color: yellow; margin: 10px; }
        .players { margin-top: 20px; }
        .error { color: red; }
    </style>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script>
        const socket = io();
        socket.on('update_game_state', (data) => {
            document.getElementById('players').innerHTML = data.players.map(p => `${p.name} (guess ${p.guess})`).join('<br>');
        });
        socket.on('update_countdown', (data) => {
            const timer = document.getElementById('timer');
            if (data.countdown_active && data.remaining_time > 0) {
                timer.textContent = `Time left: ${Math.ceil(data.remaining_time)}s`;
                timer.style.display = 'block';
            } else {
                timer.style.display = 'none';
            }
        });
        socket.on('redirect_to_result', () => window.location.href = '/result');
    </script>
</head>
<body>
    <h1>Welcome to the Numbers Game!</h1>
    <p>Nice to see you at the numbers game!</p>
    <p>Enter your name and try to guess the number in the middle (not the lowest and not the highest).</p>
    <p>Numbers are from 1 to 100.</p>
    <p>The game will start when we have at least 3 players.</p>
    <p>+10 extra seconds if more players want to join.</p>
    <div id="timer" class="timer" style="display: none;"></div>
    <form method="POST" action="/">
        <input type="text" name="name" placeholder="Your name" required><br>
        <input type="number" name="guess" placeholder="Your guess" min="1" max="100" required><br>
        <button type="submit">Join Game</button>
    </form>
    {% if error %}
        <p class="error">{{ error }}</p>
    {% endif %}
    <div class="players" id="players">
        {% for player in players %}
            {{ player.name }} (guess {{ player.guess if game_started else 'hidden' }})
            <br>
        {% endfor %}
    </div>
</body>
</html>
